<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Conix Language Reference</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="./latex.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="conix-language-reference">Conix Language Reference</h1>
<p>Below are Nix expressions that are converted into core like data structures:</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Nix Expression</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;strings&gt;, &lt;numbers&gt;, &lt;booleans&gt;</td>
<td>Write the text (or multiline text) to the current file</td>
</tr>
<tr class="even">
<td>././foo/bar.png</td>
<td>Include the given file in the current directory. No text is produced.</td>
</tr>
<tr class="odd">
<td>{ name = &lt;content&gt;; }</td>
<td>Add &lt;content&gt; to <code>data.${name}</code> and create a reference in <code>refs.${name}</code>. &lt;content&gt; is also evaluated as if the braces weren’t there.</td>
</tr>
<tr class="even">
<td>[&lt;content&gt; &lt;content&gt; …]</td>
<td>Concatenate the text of the &lt;content&gt;s and merge the derivations produced by &lt;content&gt;s into a directory</td>
</tr>
<tr class="odd">
<td>conix: with conix; &lt;content&gt;</td>
<td>Brings <code>data</code>, <code>refs</code>, and the conix library into &lt;content&gt;’s scope.</td>
</tr>
</tbody>
</table>
<h2 id="glossary">Glossary</h2>
<dl>
<dt>content</dt>
<dd>Conix code is just normal Nix source code that is evaluated to produce the stuff that goes into text files and documents as well a derivation containing those documents. We need a term to differentiate between normal Nix code and Nix code that is to be evaluated by Conix. That is what we call “content”: normal Nix code that is evaluated by Conix to produce the document contents and the documents themselves.
</dd>
<dt><code>data</code></dt>
<dd>An attribute set containing all user defined variables. You can set a value in data via the attribute set syntax.
</dd>
<dd>NOTICE: Do not use the <code>with</code> syntax with <code>data</code> (i.e: <code>with data;</code>). Under the hood nix needs to evaluate just enough of data to get its toplevel attribute keys. Because <code>data</code> is the result of a fixed-point <code>with data;</code> will result in infinite recursion. <code>refs</code>
</dd>
<dd>An attribute set containing all user defined content references.
</dd>
<dd>_NOTE: the warning for data also applies to <code>refs</code>. I.e: don’t write <code>with refs;</code>.
</dd>
<dt>content reference</dt>
<dd>A content reference is the mechanism that Conix provides for creating things like HTML hyper-links, or LaTeX’s <code>hyperref</code>. A content reference is created using the attribute set syntax and can be consumed using <code>refs</code>. To
</dd>
</dl>
<p>Like an anchor tag in html but more abstract. Creating a content reference tells Conix to remember how to get to that particular piece of content from the very top of the output derivation’s file structure. If the target content points to a file then a file path will be generated. If it points to content within a file (say a paragraph) then the file path up to that file is created and then the file path is extended with an anchor tag syntax. For example: <code>dir "bar" (html "foo"  { someRef = "jazz"; })</code> creates a ref: <code>refs.somRefs = "./bar/foo.html#someRef"</code></p>
</body>
</html>
